<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chat with Dante</title>

<!-- Updated Socket.IO version -->
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Orbitron:wght@700&display=swap');

:root {
    --background-color: #121212;
    --surface-color: #1e1e1e;
    --primary-color: #bb86fc;
    --primary-variant-color: #3700b3;
    --secondary-color: #03dac6;
    --text-color: #e0e0e0;
    --border-color: #333;
    --dante-name-color: #f44336;
    --user-name-color: #03a9f4;
}

body {
    font-family: 'Roboto', sans-serif;
    background-color: var(--background-color);
    color: var(--text-color);
    margin: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.chat-container {
    width: 90%;
    max-width: 800px;
    height: 95vh;
    background-color: var(--surface-color);
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    display: flex;
    flex-direction: column;
    border: 1px solid var(--border-color);
}

.chat-header {
    padding: 20px;
    background: linear-gradient(45deg, var(--primary-variant-color), #6200ea);
    border-bottom: 1px solid var(--border-color);
    border-radius: 15px 15px 0 0;
    text-align: center;
}

.chat-header h1 {
    margin: 0;
    font-family: 'Orbitron', sans-serif;
    font-size: 2rem;
    color: white;
    text-shadow: 0 0 10px var(--secondary-color);
}

.chat-messages {
    flex-grow: 1;
    padding: 20px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.chat-messages::-webkit-scrollbar {
    width: 8px;
}
.chat-messages::-webkit-scrollbar-track {
    background: var(--surface-color);
}
.chat-messages::-webkit-scrollbar-thumb {
    background-color: var(--primary-color);
    border-radius: 10px;
    border: 2px solid var(--surface-color);
}

.message { display: flex; flex-direction: column; max-width: 75%; animation: fadeIn 0.3s ease-in-out; }
.message .sender { font-weight: 700; font-size: 0.9em; margin-bottom: 5px; }
.message .text-bubble { padding: 12px 18px; border-radius: 20px; line-height: 1.5; }

.user-message { align-self: flex-end; align-items: flex-end; }
.user-message .sender { color: var(--user-name-color); }
.user-message .text-bubble { background-color: var(--primary-color); color: #121212; border-bottom-right-radius: 5px; }

.bot-message { align-self: flex-start; align-items: flex-start; }
.bot-message .sender { color: var(--dante-name-color); }
.bot-message .text-bubble { background-color: #333; color: var(--text-color); border-bottom-left-radius: 5px; }

@keyframes fadeIn { from { opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);} }

.chat-input {
    display: flex;
    padding: 20px;
    border-top: 1px solid var(--border-color);
}
#message-input { flex-grow:1; padding:12px 15px; border:1px solid var(--border-color); border-radius:25px; background-color:#2c2c2c; color:var(--text-color); font-size:1rem; margin-right:10px; outline:none; transition:border-color 0.3s; }
#message-input:focus { border-color: var(--primary-color); }
#send-button { padding:12px 25px; border:none; background-color: var(--primary-color); color:#121212; border-radius:25px; cursor:pointer; font-weight:700; font-size:1rem; transition:0.3s; }
#send-button:hover { background-color: var(--secondary-color); }
#send-button:active { transform: scale(0.98); }
</style>
</head>
<body>

<div class="chat-container">
    <header class="chat-header"><h1>DANTE</h1></header>
    <main class="chat-messages" id="chat-messages"></main>
    <footer class="chat-input">
        <input type="text" id="message-input" placeholder="Ask Dante anything...">
        <button id="send-button">Send</button>
    </footer>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const socket = io();
    const chatMessages = document.getElementById('chat-messages');
    const messageInput = document.getElementById('message-input');
    const sendButton = document.getElementById('send-button');

    function appendMessage(sender, message) {
        const messageType = sender === 'Dante' ? 'bot' : 'user';
        const messageElement = document.createElement('div');
        messageElement.classList.add('message', `${messageType}-message`);
        const senderElement = document.createElement('div');
        senderElement.classList.add('sender');
        senderElement.textContent = sender;
        const textBubble = document.createElement('div');
        textBubble.classList.add('text-bubble');
        textBubble.textContent = message;
        messageElement.appendChild(senderElement);
        messageElement.appendChild(textBubble);
        chatMessages.appendChild(messageElement);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function sendMessage() {
        const message = messageInput.value.trim();
        if (!message) return;
        appendMessage('You', message);
        // Emit to server
        socket.emit('user_message', { message });
        messageInput.value = '';
    }

    socket.on('connect', () => console.log('Connected to server'));

    socket.on('response', (data) => appendMessage('Dante', data.data));

    sendButton.addEventListener('click', sendMessage);
    messageInput.addEventListener('keypress', (e) => { if(e.key==='Enter') sendMessage(); });
});
</script>

</body>
</html>
